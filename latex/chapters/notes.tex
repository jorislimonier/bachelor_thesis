\chapter{Notes}

\begin{equation}
    \label{def: linear model (matrix)}
    \Y = \X \beta + \eps
\end{equation}

We define $\hat \beta$ as follows
\begin{equation}
    \label{not: beta hat}
    \hat{\beta}:=\arg \min _{\beta}\left\{\frac{\|\Y-\X \beta\|_{2}^{2}}{n}+\lambda\|\beta\|_{1}\right\}
\end{equation}

\begin{lemma}[Basic Inequality]
    $$\frac{\| \X (\hat{\beta}-\beta^{0})\|_{2}^{2}}{n} + \lambda\|\hat{\beta}\|_{1} \leq 2 \frac{\varepsilon^{T} \X (\hat{\beta}-\beta^{0})}{n}+\lambda\|\beta^{0}\|_{1}$$
\end{lemma}
\begin{proof}
    By definition of $\hat \beta$, we have that
    $$
        \forall \beta \quad \frac{\| \Y-\X \hat \beta \|_{2}^{2}}{n} + \lambda \| \hat \beta \|_{1} \leq \frac{\|\Y-\X \beta \|_{2}^{2}}{n}+\lambda \| \beta \|_{1}
    $$
    In particular for $\beta = \beta^0$ we have
    $$
        \frac{\| \Y-\X \hat \beta \|_{2}^{2}}{n}+\lambda\| \hat \beta \|_{1} \leq \frac{ \| \Y-\X \beta^0\|_{2}^{2}}{n}+\lambda \| \beta^0\|_{1}
    $$
    We now replace $\Y$ using equation \eqref{def: linear model (matrix)}.
    \begin{align*}
                 & \frac{\|\Y  - \X \hat{\beta} \|_{2}^{2}}{n} + \lambda \| \hat{\beta}\|_{1} \leq \frac{\| \Y  - \X \beta^0 \|_2^2}{n}+\lambda\|\beta^{0}\|_{1}                                                       \\
        \implies &
        \frac{\| (\X \beta^0 + \eps) - \X \hat \beta \|_{2}^{2}}{n}+\lambda\| \hat \beta \|_{1} \leq \frac{ \| (\X \beta^0 + \eps)-\X \beta^0\|_{2}^{2}}{n}+\lambda \| \beta^0\|_{1}                                   \\
        \implies &
        \frac{\| \X ( \beta^0 - \hat \beta) + \eps \|_{2}^{2}}{n} + \lambda\| \hat \beta \|_{1} \leq \frac{ \| \X ( \beta^0 - \beta^0) + \eps \|_{2}^{2}}{n}+\lambda \| \beta^0\|_{1}                                  \\
        \implies &
        \frac{\langle \X ( \beta^0 - \hat \beta) + \eps, \X ( \beta^0 - \hat \beta) + \eps \rangle}{n}+\lambda \| \hat \beta \|_{1} \leq \frac{ \| \eps \|_{2}^{2}}{n}+\lambda \| \beta^0\|_{1}                        \\
        \implies &
        \frac{\| \X (\beta^0 - \hat \beta) \| _2^2 + \| \eps \|_2^2 + 2 \langle \X ( \beta^0 - \hat \beta),  \eps \rangle}{n}+\lambda \| \hat \beta \|_{1} \leq \frac{ \| \eps \|_{2}^{2}}{n}+\lambda \| \beta^0\|_{1} \\
        \implies &
        \frac{\| \X (\hat \beta - \beta^0) \| _2^2}{n} + \lambda \| \hat \beta \|_{1} \leq \frac{2 \langle \X ( \hat \beta - \beta^0),  \eps \rangle}{n} + \lambda \| \beta^0\|_{1}                                    \\
        \implies &
        \frac{\| \X (\hat \beta - \beta^0) \| _2^2}{n} + \lambda \| \hat \beta \|_{1} \leq \frac{2 \eps^T \X ( \hat \beta - \beta^0)}{n} + \lambda \| \beta^0\|_{1}                                                    \\
    \end{align*}
\end{proof}

Let
$$\mathscr{T} := \left\{\max _{1 \leq j \leq p} 2 \frac{\left| \varepsilon^{T} \mathbf{X}^{(j)}\right|}{n} \leq \lambda_{0}\right\}$$

\begin{lemma}[Lemma 6.2.]
    For all $t > 0$ and
    $$\lambda_{0}:=2 \sigma \sqrt{\frac{t^{2}+2 \log p}{n}}$$
    we have
    $$\mathbb{P}(\mathscr{T}) \geq 1-2 \exp \left[-t^{2} / 2\right]$$
\end{lemma}
\begin{proof}
    We define
    $$V_{j} := \frac{\varepsilon^{T} \mathbf{X}^{(j)}}{\sqrt{n \sigma^{2}}}$$
    Then we have
    \begin{align*}
        \mathbb{P}(\mathscr{T}) & = \P \left( \left\{\max _{1 \leq j \leq p} 2 \frac{\left| \varepsilon^{T} \mathbf{X}^{(j)}\right|}{n} \leq 2 \sigma \sqrt{\frac{t^{2}+2 \log p}{n}} \right\} \right) \\
                                & =
        \P \left( \left\{\max _{1 \leq j \leq p} \frac{\varepsilon^{T} \mathbf{X}^{(j)}}{\sqrt{n \sigma^{2}}} \leq \sqrt{t^{2}+2 \log p} \right\} \right)                                              \\
                                & =
        \P \left( \left\{\max _{1 \leq j \leq p} | V_{j} | \leq \sqrt{t^{2}+2 \log p} \right\} \right)                                                                                                 \\
                                & =
        1 - \P \left( \left\{\max _{1 \leq j \leq p} | V_{j} | > \sqrt{t^{2}+2 \log p} \right\} \right)                                                                                                \\
    \end{align*}
\end{proof}


\begin{theorem}[Compatibility condition]
    We say that the compatibility condition is met for the set $S_{0}$, if for some $\phi_{0}>0$, and for all $\beta$ satisfying $\left\|\beta_{S_{0}^{c}}\right\|_{1} \leq 3\left\|\beta_{S_{0}}\right\|_{1}$, it holds that
    $$
        \left\| \beta_{S_{0}} \right\|_{1}^{2} \leq\left(\beta^{T} \hat{\Sigma} \beta\right) s_{0} / \phi_{0}^{2}
    $$
\end{theorem}

\begin{theorem}[Theorem 6.1.]
    Suppose the compatibility condition holds for $S_{0}$. Then on $\mathscr{T}$, we have for $\lambda \geq 2 \lambda_{0}$,
    $$
        \left\|\mathbf{X}\left(\hat{\beta}-\beta^{0}\right)\right\|_{2}^{2} / n+\lambda\left\|\hat{\beta}-\beta^{0}\right\|_{1} \leq 4 \lambda^{2} s_{0} / \phi_{0}^{2}
    $$
\end{theorem}

\begin{theorem}[Compatibility condition for general sets]
    We say that the compatibility condition holds for the set $S$, if for some constant $\phi(S)>0,$ and for all $\beta,$ with $\left\|\beta_{S^{c}}\right\|_{1} \leq$ $3\left\|\beta_{S}\right\|_{1},$ one has
    $$
        \left\|\beta_{S}\right\|_{1}^{2} \leq\left(\beta^{T} \hat{\Sigma} \beta\right)|S| / \phi^{2}(S)
    $$
\end{theorem}